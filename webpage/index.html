<HTML>
<HEAD>
    <TITLE>Crystal: Distributed Version Control Speculative Conflict Detector</TITLE>
</HEAD>


<body bgcolor=#FFFF99>


<h1>Crystal: Distributed Version Control Speculative Conflict Detector</h1> 


<p> 
Crystal's goal is to increase developer awareness of potential version control conflicts.  For example, it seeks to inform a developer of the answer to the question, &#8220;Might my changes conflict with others' changes?&#8221;
</p>

<p>
Crystal keeps an eye on all the participating developers' repositories.  It informs each developer when it is safe to push her changes, when she has fallen behind and could pull changes from others or a central repository, and when changes other developers have made will cause a syntactic (or, soon to be implemented, behavioral) conflict.
</p>
<ul>
<li>If conflicts occur, Crystal informs developers early, so they may discuss and resolve these conflicts while the causes are fresh in their minds.  Long-established conflicts can be much harder to resolve.</li>
<li>If changes are made (locally or remotely) without conflicts, Crystal increases developers' confidence that the changes will not cause problems for the team.</li>
</ul>


<p>
The Crystal client is now in beta and is available for <a href="#download">download</a>.  
</p>

<h2>Requirements:</h2> 

<UL>
<LI> <a href="http://java.sun.com/javase/downloads/index.jsp">JRE (Java Runtime Environment).</a></LI>
<LI> <a href="http://mercurial.selenic.com">Mercurial</a>, version <b>1.6 or later</b>.</LI>
<LI> The fetch mercurial extension must be enabled.  To do this, add the following text to your hg configuration file: <tt>~/.hgrc</tt> on linux, or <tt>mercurial.ini</tt> on Windows.  (There is nothing after the "<tt>=</tt>" in "<tt>fetch=</tt>".)
<pre>
[extensions]
fetch=
</pre>
</ul>


<h2 id="download">To run Crystal:</h2>

<OL>
<LI> Download <a href="crystal.jar">crystal.jar</a>. (Current version is 0.1.20100730.)</LI>
<LI> Run &#8220;java -jar crystal.jar&#8221;.</LI>
<LI> The tool will complain that your configuration file is invalid and give you instructions on how to fix it.  Your configuration file must contain:
  <UL>
  <LI> The path to a scratch directory,</LI>
  <LI> The path to the hg executable,</LI>
  <LI> For each project you wish to track, its name, type (Crystal only supports mercurial, for now), and a set of your collaborators' repositories.</LI>
  </UL>
<LI> Restart Crystal.  Crystal will run as an icon in your task bar.  Click on the icon to see the full client and more options.</LI>
</OL>

<h2>Crystal screen shot: </h2>

<p>
<img src="CrystalScreenShot.png" alt="A screen shot of the Crystal tool."></img>
</p>

<h3>Crystal summarizes the relationship between your and other repositories using the following icons:</h3>

<table border=2 width=640 cellpadding=10>
  <tr>
    <th align=center>Crystal Icon</th>
    <th align=center>Meaning of the icon</th>
  </tr>
  <tr>
    <td align=center><img src="same.png" height="48" alt="green checkmark"></img></td>
    <td align=left>The repositories are in sync.</td>
  </tr>
  <tr>
    <td align=center><img src="ahead.png" height="48" alt="green checkmark with P"></img></td>
    <td align=left>Your repository has newer commits than this one.  You may consider pushing your changes or letting the owner know.</td>
  </tr>
  <tr>
    <td align=center><img src="behind.png" height="48" alt="yellow warning"></img></td>
    <td align=left>This repository has newer commits than yours.  You may consider pulling changes to avoid later merges.</td>
  </tr>
  <tr>
    <td align=center><img src="merge.png" height="48" alt="yellow merge"></img></td>
    <td align=left>Each of the two repositories has commits not present in the other one, but they can be merged cleanly at this time. </td>
  </tr>
  <tr>
    <td align=center><img src="mergeconflict.png" height="48" alt="red merge"></img></td>
    <td align=left>Each of the two repositories has commits not present in the other one and merging them will result in a textual conflict. </td>
  </tr>
  
  <!-- tr
    <td align=center><img src="compileconflict.png" height="48" alt="red merge with a C"></img></td>
    <td align=left><b>Not currently implemented.</b>  Both repositories have new commits and merging them does not result in a textual conflict but the result does not compile. </td>
  </tr>
  <tr>
    <td align=center><img src="testconflict.png" height="48" alt="red merge with a T"></img></td>
    <td align=left><b>Not currently implemented.</b>  Both repositories have new commits and merging them does not result in a textual or compilation conflict, but the result does not pass at least one test that either your or this repository passes. </td>
  </tr> 
  -->
</table>

<h2>Configuration File Format</h2>

<p>The Crystal configuration file is an XML file that describes the locations of the scratch space and the hg executable, as well as contains information on the repositories crystal monitors.  
</p>

<p>
Here is an example valid configuration file:
</p>

<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ccConfig tempDirectory=&quot;C:/temp/conflictClient/&quot; hgPath=&quot;C:/Program Files/TortoiseHg/hg.exe&quot;&gt;
  &lt;project myKind=&quot;HG&quot; myShortName=&quot;MyFirstProject&quot; myClone=&quot;C:/projects/myLocalFirstProjectRepo/&quot;&gt;
    &lt;source myKind=&quot;HG&quot; myShortName=&quot;MASTER&quot; myClone=&quot;ssh://user@host/path/to/repo/&quot; /&gt;
    &lt;source myKind=&quot;HG&quot; myShortName=&quot;Friend&quot; myClone=&quot;ssh://user@host/path/to/friend/repo/&quot; /&gt;
  &lt;/project&gt;
  &lt;project myKind=&quot;HG&quot; myShortName=&quot;MySecondProject&quot; myClone=&quot;C:/projects/myLocalSecondProjectRepo/&quot;&gt;
    &lt;source myKind=&quot;HG&quot; myShortName=&quot;MASTER&quot; myClone=&quot;ssh://user@host/path/to/socond/project/repo/&quot; /&gt;
    &lt;source myKind=&quot;HG&quot; myShortName=&quot;Friend&quot; myClone=&quot;ttps://user@host/path/to/friend/second/repo&quot; /&gt;
  &lt;/project&gt;
&lt;/ccConfig&gt;
</pre>

<p>
At the root level, there is a single XML element: <tt>ccConfig</tt>.  This element has two attributes: <tt>tempDirectory</tt> and <tt>hgPath</tt>.  These attributes show the path to the scratch space and the hg executable, respectively.  
</p>

<p>
For each project you wish Crystal to track, <tt>ccConfig</tt> will have a <tt>project</tt> child with three attributes: <tt>myKind</tt>, <tt>myShortName</tt>, and <tt>myClone</tt>.  The <tt>myKind</tt> element describes the kind of the repository: HG for mercurial or GIT for git, although, for now, Crystal only supports HG.  The <tt>myShortName</tt> element is the name of the project you want Crystal to display (on the left side on the screen shot above).  The <tt>myClone</tt> element is the path to your local repository; you can put any address that can legally go after the <tt>&quot;hg clone&quot;</tt> command.  
</p>

Finally, for each repository you wish Crystal to compare to your repository, the <tt>project</tt> element will have a <tt>source</tt> child with three attributes: <tt>myKind</tt>, <tt>myShortName</tt>, and <tt>myClone</tt>.  The <tt>myKind</tt> element is identical to the parent <tt>project</tt>'s <tt>myKind</tt> element.  The <tt>myShortName</tt> element is the name of the repository you want Crystal to display (above the icons on the screen shot above).  The <tt>myClone</tt> element is the path to this repository; again, you can put any address that can legally go after the <tt>&quot;hg clone&quot;</tt> command.  
</p>

<h2>Contacts: </h2>

<p>
Crystal is designed and developed by <a href="http://www.cs.washington.edu/homes/brun">Yuriy Brun</a>, <a href="http://www.cs.washington.edu/homes/rtholmes">Reid Holmes</a>, <a href="http://www.cs.washington.edu/homes/mernst">Michael Ernst</a>, and <a href="http://www.cs.washington.edu/homes/notkin">David Notkin</a>.  <br>
<a href="mailto:brun@cs.washington.edu">Email us</a> with any questions.  
</p>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7528475-1");
pageTracker._trackPageview();
} catch(err) {}</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7528475-4");
pageTracker._trackPageview();
} catch(err) {}</script>


</body>
</html>